<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="428px" preserveAspectRatio="none" style="width:1211px;height:428px;background:#FFFFFF;" version="1.1" viewBox="0 0 1211 428" width="1211px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="416.3906" style="stroke:#181818;stroke-width:0.5;" width="735.5" x="259.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139" x="557.75" y="18.0669">kubernetes cluster</text><rect fill="#FFFFFF" height="56.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="851.5" y="141.5625"/><rect fill="#FFFFFF" height="56.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="851.5" y="268.9609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="343.0938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="307.5" x2="307.5" y1="81.2969" y2="343.0938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="856" x2="856" y1="81.2969" y2="343.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="77.9951">user</text><ellipse cx="23.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.5,21.5 L23.5,48.5 M10.5,29.5 L36.5,29.5 M23.5,48.5 L10.5,63.5 M23.5,48.5 L36.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="355.0889">user</text><ellipse cx="23.5" cy="366.8906" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.5,374.8906 L23.5,401.8906 M10.5,382.8906 L36.5,382.8906 M23.5,401.8906 L10.5,416.8906 M23.5,401.8906 L36.5,416.8906 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="263.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="270.5" y="69.9951">Cluster API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="263.5" y="342.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="270.5" y="362.0889">Cluster API</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="269" x="722" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="729" y="69.9951">Lifecycle hook extension deployment</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="269" x="722" y="342.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="729" y="362.0889">Lifecycle hook extension deployment</text><rect fill="#FFFFFF" height="56.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="851.5" y="141.5625"/><rect fill="#FFFFFF" height="56.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="851.5" y="268.9609"/><polygon fill="#181818" points="295.5,108.4297,305.5,112.4297,295.5,116.4297,299.5,112.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="23.5" x2="301.5" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="30.5" y="107.3638">kubectl apply cluster CRDs to trigger flow</text><polygon fill="#181818" points="839.5,137.5625,849.5,141.5625,839.5,145.5625,843.5,141.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="845.5" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="482" x="314.5" y="136.4966">POST /hooks.runtime.cluster.x-k8s.io/v1alpha1/beforeclustercreate/{name}</text><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="903.5" y1="170.6953" y2="170.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="903.5" x2="903.5" y1="170.6953" y2="183.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="862.5" x2="903.5" y1="183.6953" y2="183.6953"/><polygon fill="#181818" points="872.5,179.6953,862.5,183.6953,872.5,187.6953,868.5,183.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="317" x="868.5" y="165.6294">perform required actions before cluster is created</text><polygon fill="#181818" points="318.5,193.6953,308.5,197.6953,318.5,201.6953,314.5,197.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="855.5" y1="197.6953" y2="197.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="349.5" y1="226.8281" y2="226.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="349.5" x2="349.5" y1="226.8281" y2="239.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="308.5" x2="349.5" y1="239.8281" y2="239.8281"/><polygon fill="#181818" points="318.5,235.8281,308.5,239.8281,318.5,243.8281,314.5,239.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="314.5" y="221.7622">create cluster</text><polygon fill="#181818" points="839.5,264.9609,849.5,268.9609,839.5,272.9609,843.5,268.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="307.5" x2="845.5" y1="268.9609" y2="268.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525" x="314.5" y="263.895">POST /hooks.runtime.cluster.x-k8s.io/v1alpha1/aftercontrolplaneinitialized/{name}</text><line style="stroke:#181818;stroke-width:1.0;" x1="861.5" x2="903.5" y1="298.0938" y2="298.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="903.5" x2="903.5" y1="298.0938" y2="311.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="862.5" x2="903.5" y1="311.0938" y2="311.0938"/><polygon fill="#181818" points="872.5,307.0938,862.5,311.0938,872.5,315.0938,868.5,311.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336" x="868.5" y="293.0278">perform required actions when control plane is ready</text><polygon fill="#181818" points="318.5,321.0938,308.5,325.0938,318.5,329.0938,314.5,325.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="855.5" y1="325.0938" y2="325.0938"/><!--MD5=[589168b1b50973dbbf55e5fa86a91a93]
@startuml ClusterAPI-Lifecycle-Hook-Extension

actor user
box "kubernetes cluster"
  participant "Cluster API" as capi
  participant "Lifecycle hook extension deployment" as hook
end box

user -> capi: kubectl apply cluster CRDs to trigger flow
capi -> hook: POST /hooks.runtime.cluster.x-k8s.io/v1alpha1/beforeclustercreate/{name}
activate hook
hook -> hook: perform required actions before cluster is created
hook - -> capi
deactivate hook
capi -> capi: create cluster
capi -> hook: POST /hooks.runtime.cluster.x-k8s.io/v1alpha1/aftercontrolplaneinitialized/{name}
activate hook
hook -> hook: perform required actions when control plane is ready
hook - -> capi
deactivate hook

@enduml

PlantUML version 1.2022.7(Mon Aug 22 12:01:30 CDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>